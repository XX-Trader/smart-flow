# 任务优先级评分系统

> **版本**: v2.1.0
> **创建日期**: 2026-01-07
> **用途**: 任务拆解后，评估子任务对完成整体任务（主逻辑）的必要程度
> **原则**: 主逻辑优先，依赖关系清晰，成本风险可控

---

## 🎯 核心理念

### 主逻辑 vs 子逻辑

**主逻辑**：任务的核心流程，是任务存在的基础

**子逻辑**：辅助功能、边缘功能，增强体验或扩展功能

**关联性判断**：
- **强关联**：缺少后主逻辑无法运行 → 必须优先完成
- **中等关联**：缺少后主逻辑能运行，但体验/完整性受影响 → 第一期完成
- **弱关联**：缺少后不影响主逻辑 → 后续迭代
- **无关联**：完全可选，装饰性功能 → 有时间再做

---

## 📊 评分维度（100分制）

### 1. 主逻辑关联性（50分）⭐ 最核心

评估子任务与主逻辑的关联程度

- **必需（50分）**：主逻辑的核心组成部分
  - 缺少后主逻辑**无法运行**
  - 例：博客系统的文章发布功能、用户登录功能

- **重要（30分）**：显著影响主逻辑的完整性
  - 缺少后主逻辑**能运行**，但体验**严重受损**
  - 例：博客系统的文章编辑功能、图片上传功能

- **可选（10分）**：不影响主逻辑运行
  - 缺少后主逻辑**正常运行**，只是缺少增强功能
  - 例：博客系统的文章点赞功能、分享功能

### 2. 功能依赖度（30分）

评估该任务被其他功能依赖的程度

- **被多依赖（30分）**：被3个以上功能依赖
  - 例：用户认证功能（被发布、评论、个人中心等多个功能依赖）

- **被少依赖（20分）**：被1-2个功能依赖
  - 例：文章分类功能（主要被文章发布功能依赖）

- **无依赖（10分）**：独立功能，不被其他功能依赖
  - 例：文章分享功能（独立功能）

### 3. 实现成本（20分）

评估实现的难度和风险

- **低成本（20分）**：1-2天，技术成熟，风险低
  - 例：文章列表展示、简单的CRUD操作

- **中等成本（15分）**：3-5天，需要一定调研，有风险
  - 例：图片上传和存储、第三方登录

- **高成本（5分）**：1周以上，技术复杂，风险高
  - 例：实时通信、复杂的数据分析

---

## 🎯 快速评分示例

### 示例 1: 博客系统主逻辑识别

**主逻辑**：用户能发布文章 → 其他用户能查看文章

```yaml
主逻辑任务:
  1. 用户注册/登录
     主逻辑关联性: 50/50 (必需 - 没有用户无法发布)
     功能依赖度: 30/30 (被多依赖 - 后续所有功能都需要)
     实现成本: 15/20 (中等 - 需要密码加密)
     总分: 95/100 ✅ 核心优先级 P0

  2. 文章发布功能
     主逻辑关联性: 50/50 (必需 - 这是主逻辑本身)
     功能依赖度: 20/30 (被少依赖 - 主要是个人中心依赖)
     实现成本: 15/20 (中等 - 需要编辑器)
     总分: 85/100 ✅ 核心优先级 P0

  3. 文章列表/查看
     主逻辑关联性: 50/50 (必需 - 这是主逻辑本身)
     功能依赖度: 10/30 (无依赖 - 独立展示功能)
     实现成本: 20/20 (低成本 - 简单查询)
     总分: 80/100 ✅ 核心优先级 P0
```

### 示例 2: 中等优先级任务

```yaml
中等优先级任务:
  1. 文章编辑功能
     主逻辑关联性: 30/50 (重要 - 没有编辑只能删除重发，体验差)
     功能依赖度: 10/30 (无依赖 - 独立功能)
     实现成本: 15/20 (中等 - 需要编辑器)
     总分: 55/100 ⚠️ 第一期 P1

  2. 图片上传功能
     主逻辑关联性: 30/50 (重要 - 纯文本文章可接受，但体验受限)
     功能依赖度: 20/30 (被少依赖 - 评论也需要)
     实现成本: 15/20 (中等 - 需要存储)
     总分: 65/100 ⚠️ 第一期 P1
```

### 示例 3: 低优先级任务

```yaml
低优先级任务:
  1. 文章评论功能
     主逻辑关联性: 10/50 (可选 - 不影响发布和查看)
     功能依赖度: 10/30 (无依赖 - 独立功能)
     实现成本: 15/20 (中等 - 需要回复层级)
     总分: 35/100 ⏸️ 后续迭代 P2

  2. 文章点赞功能
     主逻辑关联性: 10/50 (可选 - 完全不影响主逻辑)
     功能依赖度: 10/30 (无依赖 - 独立功能)
     实现成本: 20/20 (低成本 - 简单计数)
     总分: 40/100 ⏸️ 后续迭代 P2

  3. 文章分享功能
     主逻辑关联性: 10/50 (可选 - 装饰性功能)
     功能依赖度: 10/30 (无依赖 - 独立功能)
     实现成本: 5/20 (高成本 - 需对接多个第三方API)
     总分: 25/100 ⏸️ 有时间再做 P3
```

---

## 🔄 评分流程

### Step 1: 识别主逻辑
```yaml
问题: 这个任务的核心流程是什么？
回答: [用一句话描述主逻辑]
```

### Step 2: 拆解子任务
```yaml
列出所有子任务:
  - 任务1
  - 任务2
  - 任务3
  ...
```

### Step 3: 评估每个子任务
```yaml
任务名称: [任务名]

主逻辑关联性: [50/30/10]
  理由: [为什么是必需/重要/可选？]

功能依赖度: [30/20/10]
  被哪些功能依赖: [列出依赖关系]

实现成本: [20/15/5]
  预估时间: [X天]
  技术难度: [低/中/高]

总分: [主逻辑关联性 + 功能依赖度 + 实现成本]
```

### Step 4: 排序并分类
- **80-100分**: P0 核心优先级 - 主逻辑必需，立即实现
- **60-79分**: P1 第一期 - 重要功能，第一期内完成
- **40-59分**: P2 后续迭代 - 辅助功能，有时间再做
- **<40分**: P3 可选 - 装饰性功能，最后考虑

---

## 📝 实战案例

### 案例: 电商系统任务优先级

**主逻辑识别**：
```
商家能上架商品 → 用户能浏览商品 → 用户能下单购买
```

**任务评分**：

```yaml
P0 核心优先级 (80-100分):
  ✅ 商品管理 (发布/编辑/删除) - 90分
  ✅ 商品列表/搜索/详情 - 85分
  ✅ 用户注册/登录 - 95分
  ✅ 购物车功能 - 80分
  ✅ 订单创建/支付 - 90分

P1 第一期 (60-79分):
  ⚠️ 用户中心/订单查询 - 70分
  ⚠️ 商家后台/订单管理 - 75分
  ⚠️ 商品分类/标签 - 65分
  ⚠️ 收货地址管理 - 60分

P2 后续迭代 (40-59分):
  ⏸️ 商品评价功能 - 50分
  ⏸️ 商品收藏功能 - 45分
  ⏸️ 优惠券功能 - 55分

P3 可选 (<40分):
  📅 商品推荐算法 - 35分
  📅 社交分享功能 - 25分
  📅 积分系统 - 30分
```

---

## ⚠️ 注意事项

### 常见错误

1. **错误1：把所有功能都当成必需**
   - ❌ 错误："用户评论很重要，应该是必需功能"
   - ✅ 正确："博客没有评论也能发布和查看，属于可选功能"

2. **错误2：忽略依赖关系**
   - ❌ 错误："图片上传不重要，可以最后做"
   - ✅ 正确："文章编辑和个人头像都依赖图片上传，被多依赖，应该优先"

3. **错误3：高估低成本的装饰性功能**
   - ❌ 错误："社交分享能带来流量，应该是高优先级"
   - ✅ 正确："分享不影响主逻辑，且实现复杂度高，低优先级"

### 评分原则

1. **主逻辑优先**：主逻辑关联性占50%，是最重要的维度
2. **依赖清晰**：明确任务间的依赖关系，被多依赖的优先
3. **成本可控**：在保证主逻辑的前提下，优先实现低成本高价值的任务
4. **定期回顾**：随着项目进展，主逻辑可能调整，优先级也需要动态调整

---

## 🔍 与其他评分系统的区别

### 任务优先级评分（本文件）
- **目的**：评估子任务对完成整体任务（主逻辑）的必要程度
- **用途**：任务拆解后，决定先做哪个、后做哪个
- **应用场景**：Smart Flow 任务调度、项目排期
- **关键问题**："这个任务对主逻辑有多重要？"

### 需求质量评分（requirements-clarity/SKILL.md）
- **目的**：评估需求描述的清晰度和完整性
- **用途**：需求澄清阶段，判断是否可以开始开发
- **应用场景**：需求澄清阶段
- **关键问题**："这个需求描述得够清楚吗？"

---

## 📊 版本历史

- **v2.1.0** (2026-01-07): 重构为主逻辑关联性模型，强调任务优先级

---

**维护者**: Smart Flow Team
**最后更新**: 2026-01-07
