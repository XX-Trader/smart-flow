---
name: requirements-clarity
description: "Use when user wants to build something but requirements are unclear, vague, or incomplete. Forces systematic questioning before any implementation."
---

# Requirements Clarity - 需求澄清

## ⚠️ 强制执行要求

**你必须使用 `AskUserQuestion` 工具来收集用户需求！**

当这个技能被触发时，你**必须**执行以下步骤：

1. **立即调用 `AskUserQuestion` 工具**
   - 设计 2-4 个关键问题
   - 每个问题提供 2-4 个选项
   - 支持多选时设置 `multiSelect: true`

2. **等待用户回答**
   - 不要假设用户想要什么
   - 不要自己编造需求

3. **生成结构化需求文档**
   - 基于用户的回答
   - 输出 JSON 格式的需求文档

## 概述

**核心原则**: 拒绝猜测，强制询问

在开始任何开发工作之前，必须彻底理解用户的需求。不要"自作聪明"地假设用户想要什么。通过系统性的提问，澄清所有模糊点。

## 触发条件

**自动触发**以下情况：
- 用户说"帮我做一个功能"但没有具体说明
- 需求描述少于 50 字
- 包含模糊词汇："大概"、"可能"、"应该"、"像..."
- 提到"新增"、"开发"、"实现"但缺乏细节

## 提问流程

### 第一轮：核心目标
```
1. 功能目标是什么？
   - 这个功能要解决什么问题？
   - 期望达到什么效果？

2. 目标用户是谁？
   - 谁会使用这个功能？
   - 用户的技能水平如何？
```

### 第二轮：功能范围
```
3. 核心功能有哪些？
   - 哪些是必须功能？（MVP）
   - 哪些是可选功能？（加分项）
   - 哪些功能明确不需要？

4. 有具体的参考或竞品吗？
   - 有类似的实现可以参考吗？
   - 有竞品可以模仿吗？
```

### 第三轮：技术约束
```
5. 技术栈偏好？
   - 前端：Vue/React/原生？
   - 后端：Python/Node.js/Go/Java？
   - 数据库：MySQL/PostgreSQL/MongoDB？
   - 有特定框架要求吗？

6. 约束条件？
   - 时间：有截止日期吗？
   - 性能：有性能要求吗？
   - 安全：需要特殊安全措施吗？
   - 兼容性：需要支持哪些浏览器/设备？
```

### 第四轮：验证确认
```
7. 成功标准是什么？
   - 如何判断这个功能成功了？
   - 有具体的验收标准吗？

8. 潜在风险？
   - 有什么可能出错的地方？
   - 有什么技术难点需要提前考虑？
```

## 提问技巧

### ✅ 好的提问方式
- **一次一个问题**: 不要一次问太多
- **选择题优先**: "A. Vue B. React C. 无所谓" 比 "用什么框架?" 更好
- **具体化**: "用户登录需要支持第三方登录吗(如微信/GitHub)?" 比 "还有其他要求吗?" 更好
- **举例说明**: "比如像淘宝的商品列表那样？" 帮助用户理解

### ❌ 避免的提问方式
- **多个问题**: 一次问 3+ 个问题，用户会困惑
- **开放过泛**: "你想要什么?" 太宽泛
- **术语过多**: "需要 RESTful API 还是 GraphQL?" 用户可能不懂
- **假设**: "你肯定需要数据库吧?" 不要假设

## 输出格式

完成澄清后，生成结构化需求文档：

```json
{
  "requirement_id": "REQ-2025-01-07-001",
  "timestamp": "2025-01-07T14:30:22Z",
  "project_name": "用户登录功能",
  "core_objective": "提供用户注册、登录、登出功能",
  "target_users": "网站注册用户",
  "must_have_features": [
    "用户注册(邮箱/手机号)",
    "用户登录(邮箱/手机号+密码)",
    "密码加密存储",
    "登出功能"
  ],
  "optional_features": [
    "第三方登录(微信/GitHub)",
    "记住登录状态",
    "找回密码"
  ],
  "tech_stack": {
    "frontend": "Vue 3",
    "backend": "Python/Django",
    "database": "MySQL 8.0"
  },
  "constraints": {
    "security": "密码必须加密",
    "performance": "登录响应时间 < 1秒",
    "compatibility": "支持 Chrome/Firefox/Safari"
  },
  "success_criteria": [
    "用户可以成功注册",
    "用户可以成功登录",
    "密码安全存储",
    "登出后清除会话"
  ],
  "references": [
    "GitHub 登录流程",
    "淘宝用户注册"
  ]
}
```

## 特殊情况处理

### 用户也不确定怎么办？
1. **提供选项**: "您更倾向于 A. 简单快速 B. 功能完整 C. 先做 MVP"
2. **分阶段**: "建议先做 MVP 版本，包含核心功能，后续再扩展"
3. **参考案例**: "有类似的功能可以参考吗？比如淘宝的登录？"

### 用户说"你看着办"？
不要接受！必须澄清：
```
"我理解您希望我来做决定。但为了避免浪费您的时间，
我需要确认几个关键点，否则可能做出来的东西不是您想要的..."
```

### 需求变更怎么办？
1. 记录变更点
2. 评估影响
3. 确认是否重新开始分解任务

## 检查清单

完成需求澄清前，确保：
- [ ] 功能目标清晰
- [ ] 目标用户明确
- [ ] 必须功能 vs 可选功能区分清楚
- [ ] 技术栈确定（或明确"无所谓"）
- [ ] 约束条件明确
- [ ] 有参考案例（或明确"没有")
- [ ] 成功标准可衡量

## 示例对话

### ❌ 不好的例子
```
你: 帮我做一个登录功能

AI: 好的，我马上帮你做...
[直接开始写代码，结果做出来不是用户想要的]
```

### ✅ 好的例子
```
你: 帮我做一个登录功能

AI: 我来帮你设计登录功能。在开始之前，我需要确认几个问题：

1. 这个登录功能的目标是什么？
   - [ ] A. 网站用户登录
   - [ ] B. 管理后台登录
   - [ ] C. 两者都需要

你: A，网站用户登录

AI: 明白了。第2个问题：

2. 登录方式支持哪些？
   - [ ] A. 仅邮箱+密码
   - [ ] B. 邮箱+手机号+密码
   - [ ] C. 还需要第三方登录(微信/GitHub等)

你: B，邮箱和手机号都可以

AI: 好的。第3个问题：
...

[经过系统性提问，完全理解用户需求后才动手]
```

## 后续步骤

需求澄清完成后：
1. 生成结构化需求文档（JSON 格式）
2. 进入下一阶段：任务分解 (`smart-flow:task-decomposer`)

---

**技能依赖**: 无
**后续技能**: `smart-flow:task-decomposer`
**版本**: v1.0.0
