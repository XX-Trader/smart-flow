# 简单技术方案模板

> **适用场景**: 中等功能（2个表及以上，或前后端联动）
> **填写说明**: 快速说明技术方案，不超过3分钟阅读

---

## 1. 推荐方案

**✅ 一句话说明核心方案**

新增分组表和关联表，使用Django ORM管理多对多关系。

---

## 2. 涉及的文件和模块

**✅ 需要修改/新增的文件**

### 后端
- `pm_robot/models/`: 新增 `PMTraderGroup`, `PMTraderGroupMember`
- `pm_robot/views/`: 新增分组CRUD视图
- `pm_robot/urls.py`: 新增路由 `/api/pm-robot/trader-group/`

### 前端
- `src/api/pm-robot.js`: 新增分组相关API调用
- `src/views/pm-robot/`: 新增 `TraderGroupManage.vue`
- `src/router/index.js`: 新增路由

---

## 3. 关键技术点

**✅ 需要注意的技术细节**

1. **多对多关系处理**
   - 使用Django的 `ManyToManyField` 或手动创建关联表
   - 推荐：手动创建关联表，方便扩展（如添加加入时间）

2. **级联删除**
   - 删除分组时，关联表记录自动删除
   - 交易员不受影响

3. **批量操作**
   - 使用异步任务（Celery）避免请求超时
   - 或分批次处理（每次50个）

---

## 4. 潜在风险和注意事项

**✅ 可能出问题的地方**

| 风险点 | 影响 | 应对方案 |
|--------|------|----------|
| 删除分组时交易员未处理 | 数据不一致 | 删除前检查，或使用级联删除 |
| 批量操作超时 | 用户体验差 | 使用异步任务，前端轮询结果 |
| 关联表数据量过大 | 查询慢 | 添加索引，考虑分表 |

---

## 5. 数据依赖

**🔸 是否需要迁移/初始化数据**

- ✅ 需要创建新表，执行 `makemigrations` 和 `migrate`
- 🔸 现有交易员数据不需要迁移
- 🔸 可以考虑创建一个"默认分组"，将未分组交易员自动归入

---

## 6. 工作量估算

**🔸 预计开发时间**

| 任务 | 预计时间 |
|------|----------|
| 数据库设计和迁移 | 30分钟 |
| 后端接口开发 | 2小时 |
| 前端页面开发 | 3小时 |
| 联调测试 | 1小时 |
| **总计** | **约7小时** |

---

**方案版本**: v1.0
**最后更新**: YYYY-MM-DD
**状态**: 待确认 / 已确认
